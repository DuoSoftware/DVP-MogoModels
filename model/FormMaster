var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var ObjectId = Schema.ObjectId;


var dynamicFieldSchema = new Schema({

    field: { type: String, required: true},
    type: { type: String, enum: ['text','radio','date','number','boolean','select','multiple','checkbox','checkboxes','textarea','url','phone','email','header'],required: true },
    description: String,
    title: { type: String, required: true},
    active: Boolean,
    require: Boolean,
    values: [{id:{ type: Number, required: true}, name:{ type: String, required: true}}]



});


var formMasterSchema = new Schema({

    name: { type: String,  required: true},
    company: { type: Number, required: true },
    tenant: { type: Number, required: true },
    fields: [dynamicFieldSchema]


});


var formSubmissionSchema = new Schema({

reference :{type: String, unique: true, require: true},
company: { type: Number, required: true },
tenant: { type: Number, required: true },
form: {type: ObjectId,ref: 'FormMaster',  required: true},
fields: [{field:{type:String, require: true},value:{}}]

});






formMasterSchema.index({ company: 1, tenant: 1,name: 1}, { unique: true });


var FormMaster = mongoose.model('FormMaster', formMasterSchema);
module.exports.FormMaster = FormMaster;

var FormSubmission = mongoose.model('FormSubmission', formSubmissionSchema);
module.exports.FormSubmission = FormSubmission;